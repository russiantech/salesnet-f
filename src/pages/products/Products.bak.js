import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import { useEffect, useState, useCallback } from 'react';
import ProductSummary from "./ProductSummary_0";
import { ProductAxiosService } from '../../services/net/ProductAxiosService';
import { NotificationService } from "../../services/local/NotificationService";
import { Link } from 'react-router-dom';
const Products = () => {
    const [products, setProducts] = useState([]);
    const [pageMeta, setPageMeta] = useState({});
    const [loading, setLoading] = useState(true);
    const [page, setPage] = useState(1);
    const [hasMore, setHasMore] = useState(true);
    useEffect(() => {
        fetchProducts();
    }, [page]);
    const fetchProducts = async () => {
        if (!hasMore)
            return;
        setLoading(true);
        try {
            // const res = await ProductAxiosService.fetchPage({ location: '/products', page });
            const res = await ProductAxiosService.fetchPage({ page });
            console.log('API Response:', res); // Log the response
            setProducts(prevProducts => [...prevProducts, ...res.data.products]);
            setPageMeta(res.data.page_meta);
            setHasMore(res.data.page_meta.has_next_page);
        }
        catch (err) {
            console.error('Failed to fetch products:', err); // Log the error
            NotificationService.showDialogError(err.message);
        }
        finally {
            setLoading(false);
        }
    };
    const handleScroll = useCallback(() => {
        console.log('Scroll position:', window.innerHeight + document.documentElement.scrollTop);
        if (loading || window.innerHeight + document.documentElement.scrollTop !== document.documentElement.offsetHeight)
            return;
        setPage(prevPage => prevPage + 1);
    }, [loading]);
    useEffect(() => {
        window.addEventListener('scroll', handleScroll);
        return () => {
            window.removeEventListener('scroll', handleScroll);
        };
    }, [handleScroll]);
    return (_jsx(_Fragment, { children: _jsx("main", { className: "content-wrapper", children: _jsxs("section", { className: "container pb-2 pb-sm-3 pb-md-4 pb-lg-5 mb-xxl-3", children: [_jsxs("ol", { className: "breadcrumb pt-3 mt-2 mt-md-3 mb-md-4", children: [_jsx("li", { className: "breadcrumb-item", children: _jsx("a", { href: "/", children: "Home" }) }), _jsx("li", { className: "breadcrumb-item", children: _jsx("a", { href: "/pages", children: "Pages" }) }), _jsx("li", { "aria-current": "page", className: "breadcrumb-item active", children: "products" })] }), _jsx("div", { className: "row", children: _jsxs("div", { className: "col-lg-8 col-xl-9", children: [_jsx("h1", { className: "h3 mb-sm-4", children: "A stunning Techa pro mockups for products." }), _jsxs("div", { className: "d-flex flex-column flex-md-row align-items-md-center gap-3 gap-md-4", children: [_jsxs("div", { className: "nav align-items-center gap-2 fs-sm", children: [_jsxs("a", { className: "nav-link text-body gap-1 p-0", href: "shop-catalog-marketplace.html", children: [_jsx("div", { className: "flex-shrink-0 border rounded-circle", style: {
                                                                width: "32px",
                                                            }, children: _jsx("div", { className: "ratio ratio-1x1 rounded-circle overflow-hidden", children: _jsx("img", { alt: "Avatar", src: "/assets/img/us/logos/favicon.svg" }) }) }), "Salesnet"] }), _jsx("div", { className: "text-body-secondary", children: "in" }), _jsx("a", { className: "nav-link text-body p-0", href: "shop-catalog-marketplace.html", children: "development" })] }), _jsxs("div", { className: "d-flex justify-content-between flex-grow-1 gap-4", children: [_jsx("span", { className: "badge rounded-pill text-info bg-info-subtle d-inline-flex align-items-center fs-sm", children: "65 sales" }), _jsxs("div", { className: "d-flex gap-2", children: [_jsxs("button", { className: "btn btn-sm btn-info rounded-pill animate-pulse text-info bg-info-subtle ", type: "button", children: [_jsx("i", { className: "ci-shopping-cart animate-target fs-sm ms-n1 me-1" }), "Basket"] }), _jsxs("button", { className: "btn btn-sm btn-secondary rounded-pill animate-pulse", type: "button", children: [_jsx("i", { className: "ci-heart animate-target fs-sm ms-n1 me-1" }), "12"] }), _jsxs("a", { className: "btn btn-sm btn-secondary rounded-pill animate-scale", href: "#comments", children: [_jsx("i", { className: "ci-message-circle animate-target fs-sm ms-n1 me-1" }), "3"] }), _jsxs("div", { className: "dropdown", children: [_jsx("button", { "aria-expanded": "false", "aria-label": "Share", className: "btn btn-icon btn-sm btn-secondary animate-scale rounded-circle", "data-bs-toggle": "dropdown", type: "button", children: _jsx("i", { className: "ci-share-2 animate-target fs-sm" }) }), _jsxs("ul", { className: "dropdown-menu dropdown-menu-end", style: {
                                                                        "--cz-dropdown-min-width": "8.5rem",
                                                                    }, children: [_jsx("li", { children: _jsxs("a", { className: "dropdown-item", href: "#!", children: [_jsx("i", { className: "ci-facebook fs-base me-2" }), "Facebook"] }) }), _jsx("li", { children: _jsxs("a", { className: "dropdown-item", href: "#!", children: [_jsx("i", { className: "ci-instagram fs-base me-2" }), "Instagram"] }) }), _jsx("li", { children: _jsxs("a", { className: "dropdown-item", href: "#", children: [_jsx("i", { className: "ci-linkedin fs-base me-2" }), "LinkedIn"] }) })] })] })] })] })] })] }) }), _jsxs("div", { className: "row g-4 pt-4", children: [_jsx("div", { className: "d-flex align-items-start justify-content-between border-bottom pb-3 pb-md-4", children: _jsxs("div", { className: "d-flex align-items-center", children: [_jsx("h2", { className: "h3 pe-3 me-3 mb-0", children: "African Ankaras" }), _jsx("div", { className: "d-flex align-items-center", "data-countdown-date": "demoDate", children: _jsx(Link, { to: "/categories/slug", className: "product-card-button btn btn-icon btn-dark animate-slide-end ms-2 border-2", children: _jsx("i", { className: "ci-arrow-up-right fs-base animate-target" }) }) })] }) }), _jsxs("div", { className: "row row-cols-2 row-cols-md-3 row-cols-lg-4 g-4 pt-2", children: [loading && products.length === 0 ? (Array.from({ length: 8 }).map((_, index) => (_jsx("div", { className: "col", children: _jsxs("div", { className: "product-card placeholder-wave", children: [_jsx("div", { className: "position-relative", children: _jsx("div", { className: "placeholder-img" }) }), _jsxs("div", { className: "w-100 min-w-0 px-1 pb-2 px-sm-3 pb-sm-3", children: [_jsx("div", { className: "placeholder-text" }), _jsxs("div", { className: "d-flex align-items-center justify-content-between", children: [_jsx("div", { className: "placeholder-price" }), _jsx("div", { className: "placeholder-button" })] })] })] }) }, index)))) : (products.map((product) => (_jsx(ProductSummary, { image: product.image_urls.length > 0 ? product.image_urls[0] : '', name: product.name, slug: product.slug, price: product.price, id: product.id, url: `/products/${product.slug}` }, product.id)))), loading && _jsx("h2", { children: "Loading more products..." }), _jsx("div", { className: "col", children: _jsxs("div", { className: "product-card animate-underline hover-effect-opacity bg-body rounded", children: [_jsxs("div", { className: "position-relative", children: [_jsx("div", { className: "position-absolute top-0 end-0 z-2 hover-effect-target opacity-0 mt-3 me-3", children: _jsxs("div", { className: "d-flex flex-column gap-2", children: [_jsx("button", { type: "button", className: "btn btn-icon btn-secondary animate-pulse d-none d-lg-inline-flex", "aria-label": "Add to Wishlist", children: _jsx("i", { className: "ci-heart fs-base animate-target" }) }), _jsx("button", { type: "button", className: "btn btn-icon btn-secondary animate-rotate d-none d-lg-inline-flex", "aria-label": "Compare", children: _jsx("i", { className: "ci-refresh-cw fs-base animate-target" }) })] }) }), _jsxs("div", { className: "dropdown d-lg-none position-absolute top-0 end-0 z-2 mt-2 me-2", children: [_jsx("button", { type: "button", className: "btn btn-icon btn-sm btn-secondary bg-body", "data-bs-toggle": "dropdown", "aria-expanded": "false", "aria-label": "More actions", children: _jsx("i", { className: "ci-more-vertical fs-lg" }) }), _jsxs("ul", { className: "dropdown-menu dropdown-menu-end fs-xs p-2", style: { minWidth: 'auto' }, children: [_jsx("li", { children: _jsxs("a", { className: "dropdown-item", href: "#!", children: [_jsx("i", { className: "ci-heart fs-sm ms-n1 me-2" }), "Add to Wishlist"] }) }), _jsx("li", { children: _jsxs("a", { className: "dropdown-item", href: "#!", children: [_jsx("i", { className: "ci-refresh-cw fs-sm ms-n1 me-2" }), "Compare"] }) })] })] }), _jsx("a", { className: "d-block rounded-top overflow-hidden p-3 p-sm-4", href: "./single_product.html", children: _jsx("div", { className: "ratio", style: { '--cz-aspect-ratio': 'calc(240 / 258 * 100%)' }, children: _jsx("img", { src: "assets/img/shop/electronics/02.png", alt: "iPhone 14" }) }) })] }), _jsxs("div", { className: "w-100 min-w-0 px-1 pb-2 px-sm-3 pb-sm-3", children: [_jsxs("div", { className: "d-flex align-items-center gap-2 mb-2", children: [_jsxs("div", { className: "d-flex gap-1 fs-xs", children: [_jsx("i", { className: "ci-star-filled text-warning" }), _jsx("i", { className: "ci-star-filled text-warning" }), _jsx("i", { className: "ci-star-filled text-warning" }), _jsx("i", { className: "ci-star-filled text-warning" }), _jsx("i", { className: "ci-star-half text-warning" })] }), _jsx("span", { className: "text-body-tertiary fs-xs", children: "(142)" })] }), _jsx("h3", { className: "pb-1 mb-2", children: _jsx("a", { className: "d-block fs-sm fw-medium text-truncate", href: "./single_product.html", children: _jsx("span", { className: "animate-target", children: "Apple iPhone 14 128GB White" }) }) }), _jsxs("div", { className: "d-flex align-items-center justify-content-between", children: [_jsx("div", { className: "h5 lh-1 mb-0", children: "$899.00" }), _jsx("button", { type: "button", className: "product-card-button btn btn-icon btn-secondary animate-slide-end ms-2", "aria-label": "Add to Cart", children: _jsx("i", { className: "ci-shopping-cart fs-base animate-target" }) })] })] }), _jsxs("div", { className: "product-card-details position-absolute top-100 start-0 w-100 bg-body rounded-bottom shadow mt-n2 p-3 pt-1", children: [_jsx("span", { className: "position-absolute top-0 start-0 w-100 bg-body mt-n2 py-2" }), _jsxs("ul", { className: "list-unstyled d-flex flex-column gap-2 m-0", children: [_jsxs("li", { className: "d-flex align-items-center", children: [_jsx("span", { className: "fs-xs", children: "Display:" }), _jsx("span", { className: "d-block flex-grow-1 border-bottom border-dashed px-1 mt-2 mx-2" }), _jsx("span", { className: "text-dark-emphasis fs-xs fw-medium text-end", children: "6.1\" XDR" })] }), _jsxs("li", { className: "d-flex align-items-center", children: [_jsx("span", { className: "fs-xs", children: "Capacity:" }), _jsx("span", { className: "d-block flex-grow-1 border-bottom border-dashed px-1 mt-2 mx-2" }), _jsx("span", { className: "text-dark-emphasis fs-xs fw-medium text-end", children: "128 GB" })] }), _jsxs("li", { className: "d-flex align-items-center", children: [_jsx("span", { className: "fs-xs", children: "Chip:" }), _jsx("span", { className: "d-block flex-grow-1 border-bottom border-dashed px-1 mt-2 mx-2" }), _jsx("span", { className: "text-dark-emphasis fs-xs fw-medium text-end", children: "A15 Bionic" })] }), _jsxs("li", { className: "d-flex align-items-center", children: [_jsx("span", { className: "fs-xs", children: "Camera:" }), _jsx("span", { className: "d-block flex-grow-1 border-bottom border-dashed px-1 mt-2 mx-2" }), _jsx("span", { className: "text-dark-emphasis fs-xs fw-medium text-end", children: "12 + 12 MP" })] }), _jsxs("li", { className: "d-flex align-items-center", children: [_jsx("span", { className: "fs-xs", children: "Weight:" }), _jsx("span", { className: "d-block flex-grow-1 border-bottom border-dashed px-1 mt-2 mx-2" }), _jsx("span", { className: "text-dark-emphasis fs-xs fw-medium text-end", children: "172 grams" })] })] })] })] }) }), _jsx("div", { className: "col", children: _jsxs("div", { className: "product-card animate-underline hover-effect-opacity bg-body rounded", children: [_jsxs("div", { className: "position-relative", children: [_jsx("div", { className: "position-absolute top-0 end-0 z-2 hover-effect-target opacity-0 mt-3 me-3", children: _jsxs("div", { className: "d-flex flex-column gap-2", children: [_jsx("button", { type: "button", className: "btn btn-icon btn-secondary animate-pulse d-none d-lg-inline-flex", "aria-label": "Add to Wishlist", children: _jsx("i", { className: "ci-heart fs-base animate-target" }) }), _jsx("button", { type: "button", className: "btn btn-icon btn-secondary animate-rotate d-none d-lg-inline-flex", "aria-label": "Compare", children: _jsx("i", { className: "ci-refresh-cw fs-base animate-target" }) })] }) }), _jsxs("div", { className: "dropdown d-lg-none position-absolute top-0 end-0 z-2 mt-2 me-2", children: [_jsx("button", { type: "button", className: "btn btn-icon btn-sm btn-secondary bg-body", "data-bs-toggle": "dropdown", "aria-expanded": "false", "aria-label": "More actions", children: _jsx("i", { className: "ci-more-vertical fs-lg" }) }), _jsxs("ul", { className: "dropdown-menu dropdown-menu-end fs-xs p-2", style: { minWidth: 'auto' }, children: [_jsx("li", { children: _jsxs("a", { className: "dropdown-item", href: "#!", children: [_jsx("i", { className: "ci-heart fs-sm ms-n1 me-2" }), "Add to Wishlist"] }) }), _jsx("li", { children: _jsxs("a", { className: "dropdown-item", href: "#!", children: [_jsx("i", { className: "ci-refresh-cw fs-sm ms-n1 me-2" }), "Compare"] }) })] })] }), _jsx("a", { className: "d-block rounded-top overflow-hidden p-3 p-sm-4", href: "./single_product.html", children: _jsx("div", { className: "ratio", style: { '--cz-aspect-ratio': 'calc(240 / 258 * 100%)' }, children: _jsx("img", { src: "assets/img/shop/electronics/03.png", alt: "Smart Watch" }) }) })] }), _jsxs("div", { className: "w-100 min-w-0 px-1 pb-2 px-sm-3 pb-sm-3", children: [_jsxs("div", { className: "d-flex align-items-center gap-2 mb-2", children: [_jsxs("div", { className: "d-flex gap-1 fs-xs", children: [_jsx("i", { className: "ci-star-filled text-warning" }), _jsx("i", { className: "ci-star-filled text-warning" }), _jsx("i", { className: "ci-star-filled text-warning" }), _jsx("i", { className: "ci-star-filled text-warning" }), _jsx("i", { className: "ci-star-filled text-warning" })] }), _jsx("span", { className: "text-body-tertiary fs-xs", children: "(67)" })] }), _jsx("h3", { className: "pb-1 mb-2", children: _jsx("a", { className: "d-block fs-sm fw-medium text-truncate", href: "./single_product.html", children: _jsx("span", { className: "animate-target", children: "Smart Watch Series 7, White" }) }) }), _jsxs("div", { className: "d-flex align-items-center justify-content-between", children: [_jsx("div", { className: "h5 lh-1 mb-0", children: "$429.00" }), _jsx("button", { type: "button", className: "product-card-button btn btn-icon btn-secondary animate-slide-end ms-2", "aria-label": "Add to Cart", children: _jsx("i", { className: "ci-shopping-cart fs-base animate-target" }) })] })] }), _jsxs("div", { className: "product-card-details position-absolute top-100 start-0 w-100 bg-body rounded-bottom shadow mt-n2 p-3 pt-1", children: [_jsx("span", { className: "position-absolute top-0 start-0 w-100 bg-body mt-n2 py-2" }), _jsxs("ul", { className: "list-unstyled d-flex flex-column gap-2 m-0", children: [_jsxs("li", { className: "d-flex align-items-center", children: [_jsx("span", { className: "fs-xs", children: "Display:" }), _jsx("span", { className: "d-block flex-grow-1 border-bottom border-dashed px-1 mt-2 mx-2" }), _jsx("span", { className: "text-dark-emphasis fs-xs fw-medium text-end", children: "45mm OLED" })] }), _jsxs("li", { className: "d-flex align-items-center", children: [_jsx("span", { className: "fs-xs", children: "Chip:" }), _jsx("span", { className: "d-block flex-grow-1 border-bottom border-dashed px-1 mt-2 mx-2" }), _jsx("span", { className: "text-dark-emphasis fs-xs fw-medium text-end", children: "64-bit Dual-core" })] }), _jsxs("li", { className: "d-flex align-items-center", children: [_jsx("span", { className: "fs-xs", children: "Connectivity:" }), _jsx("span", { className: "d-block flex-grow-1 border-bottom border-dashed px-1 mt-2 mx-2" }), _jsx("span", { className: "text-dark-emphasis fs-xs fw-medium text-end", children: "Wi-Fi, Bluetooth" })] }), _jsxs("li", { className: "d-flex align-items-center", children: [_jsx("span", { className: "fs-xs", children: "Power:" }), _jsx("span", { className: "d-block flex-grow-1 border-bottom border-dashed px-1 mt-2 mx-2" }), _jsx("span", { className: "text-dark-emphasis fs-xs fw-medium text-end", children: "Lithium-ion battery" })] }), _jsxs("li", { className: "d-flex align-items-center", children: [_jsx("span", { className: "fs-xs", children: "Weight:" }), _jsx("span", { className: "d-block flex-grow-1 border-bottom border-dashed px-1 mt-2 mx-2" }), _jsx("span", { className: "text-dark-emphasis fs-xs fw-medium text-end", children: "37.0 grams" })] })] })] })] }) })] })] })] }) }) }));
};
export default Products;
